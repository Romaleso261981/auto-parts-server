# Auto Parts Server API

Backend API for auto parts catalog with TypeScript and modular architecture.

## Project Structure

```
auto-parts-server/
â”œâ”€â”€ src/                      # TypeScript source files
â”‚   â”œâ”€â”€ server.ts             # Entry point
â”‚   â”œâ”€â”€ routes/               # Routing
â”‚   â”‚   â”œâ”€â”€ index.ts         # Main router
â”‚   â”‚   â”œâ”€â”€ test.ts          # /, /test
â”‚   â”‚   â”œâ”€â”€ products.ts      # /products
â”‚   â”‚   â””â”€â”€ brands.ts        # /brands
â”‚   â”œâ”€â”€ controllers/          # Controllers (HTTP request handling)
â”‚   â”‚   â”œâ”€â”€ productsController.ts
â”‚   â”‚   â””â”€â”€ testController.ts
â”‚   â”œâ”€â”€ services/             # Services (business logic)
â”‚   â”‚   â”œâ”€â”€ productsService.ts
â”‚   â”‚   â””â”€â”€ testService.ts
â”‚   â”œâ”€â”€ config/               # Configuration
â”‚   â”‚   â””â”€â”€ firebase.ts      # Firebase configuration
â”‚   â”œâ”€â”€ data/                 # Data
â”‚   â”‚   â””â”€â”€ products.ts      # Mock products data
â”‚   â”œâ”€â”€ scripts/              # Utility scripts
â”‚   â”‚   â””â”€â”€ importData.ts    # Import mock data to Firestore
â”‚   â””â”€â”€ types/                # TypeScript types
â”‚       â”œâ”€â”€ product.ts
â”‚       â””â”€â”€ index.ts
â”œâ”€â”€ dist/                     # Compiled JavaScript
â”œâ”€â”€ tsconfig.json             # TypeScript configuration
â”œâ”€â”€ package.json
â””â”€â”€ .gitignore
```

## Architecture

### ðŸ”¹ TypeScript Types (types/)
- `Product` - product interface
- `ProductFilters` - search filters

### ðŸ”¹ Service Layer (services/)
Contains business logic and data operations:
- `productsService.ts` - product retrieval and filtering from Firebase Firestore
- `testService.ts` - server information

### ðŸ”¹ Controller Layer (controllers/)
Handles HTTP requests and responses:
- `productsController.ts` - product request handling
- `testController.ts` - test request handling

### ðŸ”¹ Route Layer (routes/)
Defines API routes:
- `routes/index.ts` - mounts all routes
- `routes/test.ts` - /, /test
- `routes/products.ts` - /products, /products/:id
- `routes/brands.ts` - /brands

## API Endpoints

### Base
- `GET /api/` - Server information
- `GET /api/test` - Test endpoint

### Products
- `GET /api/products` - Get all products (query: ?brand=&search=)
- `GET /api/products/:id` - Get product by ID

### Brands
- `GET /api/brands` - Get all brands

## Development

```bash
# Install dependencies
npm install

# Import mock data to Firebase Firestore (run once)
npm run import-data

# Run in development mode (with auto-compilation)
npm run dev

# Compile TypeScript
npm run build

# Type checking (without compilation)
npm run type-check

# Run compiled code
npm start
```

## Production Build

```bash
# Compile TypeScript to JavaScript
npm run build

# Run compiled application
npm start
```

## Railway Deployment

1. Railway will automatically detect TypeScript project
2. Will run `npm run build`
3. Then `npm start`

## CORS

CORS configured to allow requests from all origins:
- Production: `https://auto-parts-client.vercel.app`
- Development: `http://localhost:3000`, `http://localhost:5173`

## Request Examples

```bash
# Get all products
curl https://auto-parts-server-test.up.railway.app/api/products

# Filter by brand
curl https://auto-parts-server-test.up.railway.app/api/products?brand=Mann

# Search by name
curl https://auto-parts-server-test.up.railway.app/api/products?search=ÐºÐ¾Ð»Ð¾Ð´ÐºÐ¸

# Get product by ID
curl https://auto-parts-server-test.up.railway.app/api/products/1

# Get all brands
curl https://auto-parts-server-test.up.railway.app/api/brands
```

## Technologies

- **TypeScript** - typed JavaScript
- **Express** - web framework
- **Firebase Firestore** - NoSQL database
- **CORS** - Cross-Origin Resource Sharing
- **tsx** - fast TypeScript execution (dev mode)

## Firebase Setup

1. The Firebase configuration is already set up in `src/config/firebase.ts`

2. **Set up Firestore Security Rules** (required for import):
   - Go to Firebase Console â†’ Firestore Database â†’ Rules
   - Use the rules from `firestore.rules` or temporarily set:
     ```javascript
     rules_version = '2';
     service cloud.firestore {
       match /databases/{database}/documents {
         match /products/{productId} {
           allow read, write: if true;
         }
       }
     }
     ```
   - **Important**: After importing, change rules to production-ready version (read-only for users)

3. Run `npm run import-data` to import mock data to Firestore

4. The data will be stored in the `products` collection
